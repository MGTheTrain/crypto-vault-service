graph TD;

%% Actors (Users)
Admin["Administrator"]
Owner["Owner"]
Grantee["Grantee"]

%% Use Cases Grouped by Domain
subgraph Blob_Management ["Blob Management"]
    UC1["UC1: Manage All Blobs"]
    UC2["UC2: Upload Own Blobs"]
    UC3["UC3: Delete Own Blobs"]
    UC4["UC4: Download Blob with Permission"]
    UC5["UC5: View Blob with Permission"]
    UC6["UC6: Manage Blob Metadata"]
    UC7["UC7: Manage Own Blob Metadata"]
    UC8["UC8: View Public Blob Metadata"]
end

subgraph Key_Management ["Key Management"]
    UC9["UC9: Manage Cryptographic Keys"]
    UC10["UC10: Manage Own Cryptographic Keys"]
    UC11["UC11: Manage Key Metadata"]
    UC12["UC12: Manage Own Key Metadata"]
    UC13["UC13: View Public Key Metadata"]
end

subgraph Key_Operations ["Key Operations"]
    UC14["UC14: Encrypt Own Blobs"]
    UC15["UC15: Decrypt Own Blobs"]
    UC16["UC16: Hash Own Blobs"]
    UC17["UC17: Verify Blob Signature"]
end

subgraph Permission_Management ["Permission Management"]
    UC18["UC18: Grant Download Permission"]
    UC19["UC19: Grant View Permission"]
end

%% Actor -> Use Cases
Admin --> UC1
Admin --> UC9
Admin --> UC10
Admin --> UC11

Owner --> UC2
Owner --> UC3
Owner --> UC4
Owner --> UC5
Owner --> UC6
Owner --> UC7
Owner --> UC8
Owner --> UC14
Owner --> UC15
Owner --> UC16
Owner --> UC17
Owner --> UC18
Owner --> UC19

Grantee --> UC4
Grantee --> UC5
Grantee --> UC15

%% Class definitions for actors
classDef actor fill:#ADD8E6,stroke:#333,stroke-width:2px;
class Admin,Owner,Grantee actor;

%% Class definitions for domains
class Blob_Management fill:#FFD700,stroke:#333,stroke-width:2px;
class Key_Management fill:#90EE90,stroke:#333,stroke-width:2px;
class Key_Operations fill:#98FB98,stroke:#333,stroke-width:2px;
class Permission_Management fill:#FF6347,stroke:#333,stroke-width:2px;
