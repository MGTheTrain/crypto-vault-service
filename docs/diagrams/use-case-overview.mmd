graph TB;

%% Actors (Users) with text below each actor and separators
subgraph Roles ["Roles"]
    direction TB
    Admin["Administrator - Full access to all operations, including managing blobs, keys, and granting permissions."]
    
    Owner["Owner - Manage own blobs and metadata. Grant permissions to others."]
    
    Grantee["Grantee - View and download blobs with permission. Decrypt blobs."]
end

%% Use Cases Grouped by Domain
subgraph Blob_Management ["Blob Management"]
    UC1["UC1: Manage All Blobs"]
    UC2["UC2: Upload Own Blobs"]
    UC3["UC3: Delete Own Blobs"]
    UC4["UC4: Download Blob with Permission"]
    UC5["UC5: View Blob with Permission"]
    UC6["UC6: Manage Blob Metadata"]
    UC7["UC7: Manage Own Blob Metadata"]
    UC8["UC8: View Public Blob Metadata"]
end

subgraph Key_Management ["Key Management"]
    UC9["UC9: Manage Cryptographic Keys"]
    UC10["UC10: Manage Own Cryptographic Keys"]
    UC11["UC11: Manage Key Metadata"]
    UC12["UC12: Manage Own Key Metadata"]
    UC13["UC13: View Public Key Metadata"]
end

subgraph Key_Operations ["Key Operations"]
    UC14["UC14: Encrypt Own Blobs"]
    UC15["UC15: Decrypt Own Blobs"]
    UC16["UC16: Hash Own Blobs"]
    UC17["UC17: Verify Blob Signature"]
end

subgraph Permission_Management ["Permission Management"]
    UC18["UC18: Grant Download Permission"]
    UC19["UC19: Grant View Permission"]
end

%% Class definitions for actors
classDef actor fill:#ADD8E6,stroke:#333,stroke-width:2px;
class Admin,Owner,Grantee actor;

%% Class definitions for domains
class Blob_Management fill:#FFD700,stroke:#333,stroke-width:2px;
class Key_Management fill:#90EE90,stroke:#333,stroke-width:2px;
class Key_Operations fill:#98FB98,stroke:#333,stroke-width:2px;
class Permission_Management fill:#FF6347,stroke:#333,stroke-width:2px;
